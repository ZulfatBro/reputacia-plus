<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Neon Voice ‚Äî –ø—Ä–æ—Å—Ç–æ–π P2P-–∑–≤–æ–Ω–æ–∫ (Discord-style)</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0f14;
      --panel: rgba(255,255,255,0.03);
      --glass: rgba(255,255,255,0.04);
      --accent:#7c5cff; /* neon accent */
      --accent-2:#00e6a8;
      --muted: #9aa4b2;
      --neon: 0 0 12px rgba(124,92,255,0.35), 0 0 30px rgba(0,230,168,0.06);
    }
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial; margin:0; background:linear-gradient(180deg,#04060a 0%, #071024 100%); color:#e6eef6; min-height:100vh;}
    .app{display:flex; gap:18px; max-width:1100px; margin:24px auto; padding:20px;}

    /* sidebar */
    .sidebar{width:84px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:14px; padding:12px; box-shadow:var(--neon); display:flex; flex-direction:column; align-items:center}
    .server{width:56px; height:56px; border-radius:14px; background:linear-gradient(135deg,var(--accent), #5fd1ff); display:flex; align-items:center; justify-content:center; font-weight:800; color:#071024; font-size:18px; box-shadow: 0 6px 30px rgba(124,92,255,0.22), inset 0 -6px 18px rgba(255,255,255,0.05)}
    .channels{margin-top:14px; width:100%}
    .chan{height:44px; display:flex; align-items:center; justify-content:center; margin-bottom:8px; border-radius:10px; cursor:pointer; color:var(--muted)}
    .chan.active{background:linear-gradient(90deg, rgba(124,92,255,0.08), rgba(0,230,168,0.04)); color:var(--accent); box-shadow:var(--neon)}

    /* main */
    .main{flex:1; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:14px; padding:18px; display:flex; flex-direction:column; gap:12px}
    .header{display:flex; justify-content:space-between; align-items:center}
    .title{font-weight:700; font-size:18px; color:#fff; display:flex; gap:10px; align-items:center}
    .title .neon{padding:6px 10px; border-radius:8px; background:linear-gradient(90deg,var(--accent),var(--accent-2)); box-shadow:var(--neon); color:#041217; font-weight:800}
    .controls{display:flex; gap:8px; align-items:center}
    .input{background:var(--glass); border:1px solid rgba(255,255,255,0.03); padding:8px 10px; border-radius:10px; color:var(--muted);}
    .btn{background:linear-gradient(90deg,var(--accent),var(--accent-2)); border:none; color:#041217; padding:8px 12px; border-radius:10px; cursor:pointer; font-weight:600}
    .btn.ghost{background:transparent; color:var(--muted); border:1px solid rgba(255,255,255,0.03)}

    .content{display:flex; gap:12px}
    .leftPanel{width:360px; display:flex; flex-direction:column; gap:12px}
    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:12px; padding:12px}
    .panel h4{margin:0 0 8px 0; font-size:13px; color:var(--muted)}

    .participants{display:flex; flex-direction:column; gap:10px}
    .member{display:flex; align-items:center; gap:10px; padding:8px; border-radius:10px; background:rgba(255,255,255,0.01);}
    .avatar{width:46px; height:46px; border-radius:10px; background: linear-gradient(135deg,var(--accent),#5fd1ff); display:flex; align-items:center; justify-content:center; font-weight:700; color:#041217}
    .member .meta{display:flex; flex-direction:column}
    .nick{font-weight:700}
    .sub{font-size:12px; color:var(--muted)}
    .micIcon{margin-left:auto; font-size:14px}

    /* right panel (controls + raw fields) */
    .right{flex:1; display:flex; flex-direction:column; gap:12px}
    textarea{background:rgba(10,14,20,0.6); border:1px solid rgba(255,255,255,0.03); color:#e6eef6; padding:10px; border-radius:8px; resize:vertical}
    .smallRow{display:flex; gap:8px}
    .hint{color:var(--muted); font-size:13px}

    footer{margin-top:8px; color:var(--muted); font-size:12px}

    /* neon glow for headings */
    .neonHeader{font-weight:800; font-size:22px; color:var(--accent); text-shadow:0 0 10px rgba(124,92,255,0.2)}

    @media(max-width:900px){.app{flex-direction:column;padding:12px}.leftPanel{width:100%}.sidebar{display:none}}
  </style>
</head>
<body>
  <div class="app">
    <div class="sidebar">
      <div class="server">NV</div>
      <div class="channels">
        <div class="chan active">#voice</div>
        <div class="chan">#chat</div>
        <div class="chan">#media</div>
      </div>
    </div>

    <div class="main">
      <div class="header">
        <div class="title"><span class="neon">NEON</span> <div style="font-size:12px;color:var(--muted)">Voice Channel</div></div>
        <div class="controls">
          <input id="nickInput" class="input" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º..." style="width:220px" />
          <button id="setNick" class="btn">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</button>
          <button id="micToggle" class="btn ghost">–ú–∏–∫—Ä–æ—Ñ–æ–Ω: –≤—ã–∫–ª</button>
        </div>
      </div>

      <div class="content">
        <div class="leftPanel">
          <div class="panel">
            <h4>–£—á–∞—Å—Ç–Ω–∏–∫–∏ –∫–∞–Ω–∞–ª–∞</h4>
            <div id="participants" class="participants">
              <!-- –ª–æ–∫–∞–ª—å–Ω—ã–π –∏ —É–¥–∞–ª—ë–Ω–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å -->
            </div>
          </div>

          <div class="panel">
            <h4>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
            <div class="hint">–û–¥–∏–Ω —Ñ–∞–π–ª HTML. –°–æ—Ö—Ä–∞–Ω–∏ –µ–≥–æ –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥ –∏ –æ—Ç–∫—Ä–æ–π –ø–æ HTTPS (–∏–ª–∏ localhost). –°–∏—Å—Ç–µ–º–∞ –∑–≤–æ–Ω–∫–æ–≤ ‚Äî P2P WebRTC —Å —Ä—É—á–Ω—ã–º –æ–±–º–µ–Ω–æ–º JSON (Offer/Answer). –¢–µ–ø–µ—Ä—å JSON –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∏–∫–Ω–µ–π–º—ã ‚Äî –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –æ–Ω–∏ –ø–æ—è–≤—è—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.</div>
          </div>
        </div>

        <div class="right">
          <div class="panel">
            <h4>–°–æ–∑–¥–∞—Ç—å Offer (–∑–≤–æ–Ω—è—â–∏–π)</h4>
            <div class="smallRow">
              <button id="createOffer" class="btn">–°–æ–∑–¥–∞—Ç—å Offer</button>
              <button id="copyOffer" class="btn ghost">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
            <textarea id="offerOut" placeholder="Offer JSON..."></textarea>
          </div>

          <div class="panel">
            <h4>–ü—Ä–∏–Ω—è—Ç—å Offer –∏ —Å–æ–∑–¥–∞—Ç—å Answer (–æ—Ç–≤–µ—á–∞—é—â–∏–π)</h4>
            <textarea id="offerIn" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Å—é–¥–∞ Offer –æ—Ç –∑–≤–æ–Ω—è—â–µ–≥–æ..."></textarea>
            <div class="smallRow" style="margin-top:8px">
              <button id="acceptOffer" class="btn">–ü—Ä–∏–Ω—è—Ç—å Offer –∏ —Å–æ–∑–¥–∞—Ç—å Answer</button>
              <button id="copyAnswer" class="btn ghost">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å Answer</button>
            </div>
            <textarea id="answerOut" placeholder="Answer JSON... (—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–≤–æ–Ω—è—â–µ–º—É)"></textarea>
          </div>

          <div class="panel">
            <h4>–ó–≤–æ–Ω—è—â–∏–π: –≤—Å—Ç–∞–≤–∏—Ç—å Answer</h4>
            <textarea id="answerIn" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Å—é–¥–∞ Answer –¥—Ä—É–≥–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ '–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Answer'"></textarea>
            <div class="smallRow" style="margin-top:8px">
              <button id="setAnswerBtn" class="btn">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Answer</button>
            </div>
            <footer>–ï—Å–ª–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ –Ω—É–∂–µ–Ω TURN. –û—Ç–∫—Ä—ã–≤–∞–π –ø–æ HTTPS.</footer>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
(async()=>{
  // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è STUN (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å TURN –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏)
  const pcConfig = { iceServers: [ { urls: ["stun:stun.l.google.com:19302"] } ] };

  let pc = null;
  let localStream = null;
  let localCandidates = [];
  let myNick = '';
  let remoteNick = '';
  const participantsEl = document.getElementById('participants');

  function createMemberEl(id, nick, isLocal=false){
    const wrap = document.createElement('div');
    wrap.className = 'member';
    wrap.id = 'member-'+id;

    const avatar = document.createElement('div'); avatar.className='avatar'; avatar.textContent = (nick||'?').slice(0,2).toUpperCase();
    const meta = document.createElement('div'); meta.className='meta';
    const n = document.createElement('div'); n.className='nick'; n.textContent = nick || 'Unknown';
    const s = document.createElement('div'); s.className='sub'; s.textContent = isLocal ? '–í—ã (–ª–æ–∫–∞–ª—å–Ω—ã–π)' : '–î–∞–ª—ë–∫–∏–π —É—á–∞—Å—Ç–Ω–∏–∫';
    meta.appendChild(n); meta.appendChild(s);

    const mic = document.createElement('div'); mic.className='micIcon'; mic.innerHTML = isLocal ? 'üé§' : 'üîä';
    wrap.appendChild(avatar); wrap.appendChild(meta); wrap.appendChild(mic);
    return {wrap, n, s, avatar, mic };
  }

  function addOrUpdateLocal(nick){
    myNick = nick || 'Me';
    const id = 'me';
    let row = document.getElementById('member-'+id);
    if(!row){
      const {wrap, n, s, avatar} = createMemberEl(id, myNick, true);
      participantsEl.prepend(wrap);
    } else {
      row.querySelector('.nick').textContent = myNick;
      row.querySelector('.avatar').textContent = myNick.slice(0,2).toUpperCase();
    }
  }

  function addRemote(nick, stream){
    const id = 'peer';
    let row = document.getElementById('member-'+id);
    if(!row){
      const {wrap, n, s, mic} = createMemberEl(id, nick, false);
      participantsEl.appendChild(wrap);
      // –¥–æ–±–∞–≤–∏—Ç—å –∞—É–¥–∏–æ–ø–ª–µ–µ—Ä
      const audio = document.createElement('audio'); audio.autoplay = true; audio.controls = true; audio.srcObject = stream; audio.style.marginTop='6px';
      wrap.appendChild(audio);
      // –æ–±–Ω–æ–≤–∏–º sub
      wrap.querySelector('.sub').textContent = '–ü–æ–¥–∫–ª—é—á—ë–Ω';
    } else {
      row.querySelector('.nick').textContent = nick || 'Peer';
      if(stream){
        let aud = row.querySelector('audio');
        if(!aud){ aud = document.createElement('audio'); aud.autoplay=true; aud.controls=true; row.appendChild(aud); }
        aud.srcObject = stream;
        row.querySelector('.sub').textContent = '–ü–æ–¥–∫–ª—é—á—ë–Ω';
      }
    }
  }

  function clearRemote(){
    const el = document.getElementById('member-peer'); if(el) el.remove();
  }

  function createPeerConnection(){
    pc = new RTCPeerConnection(pcConfig);
    localCandidates = [];

    pc.ontrack = (e)=>{
      // –¥–æ–±–∞–≤–∏–º remote —É—á–∞—Å—Ç–Ω–∏–∫–∞
      addRemote(remoteNick || 'Peer', e.streams[0]);
    };

    pc.onicecandidate = (e)=>{
      if(e.candidate) localCandidates.push(e.candidate.toJSON());
    };

    pc.onconnectionstatechange = ()=>{
      console.log('conn state', pc.connectionState);
      if(pc.connectionState === 'disconnected' || pc.connectionState === 'failed'){
        clearRemote();
      }
    };

    return pc;
  }

  async function ensureMic(){
    if(!localStream){
      localStream = await navigator.mediaDevices.getUserMedia({ audio: true });
      document.getElementById('micToggle').textContent = '–ú–∏–∫—Ä–æ—Ñ–æ–Ω: –≤–∫–ª';
    }
  }

  async function addLocalTracks(pcInstance){
    if(!localStream) return;
    for(const t of localStream.getTracks()) pcInstance.addTrack(t, localStream);
  }

  function waitIceComplete(pcInstance, timeout=7000){
    return new Promise(resolve=>{
      if(pcInstance.iceGatheringState === 'complete') return resolve();
      function check(){ if(pcInstance.iceGatheringState === 'complete'){ pcInstance.removeEventListener('icegatheringstatechange', check); resolve(); }}
      pcInstance.addEventListener('icegatheringstatechange', check);
      setTimeout(()=>{ pcInstance.removeEventListener('icegatheringstatechange', check); resolve(); }, timeout);
    });
  }

  // UI handlers
  document.getElementById('setNick').onclick = ()=>{
    const nick = document.getElementById('nickInput').value.trim() || 'Guest';
    addOrUpdateLocal(nick);
    alert('–í—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å –∫–∞–∫ ' + nick + '. –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å Offer/Answer.');
  };

  document.getElementById('micToggle').onclick = async ()=>{
    try{
      if(!localStream){ await ensureMic(); }
      const enabled = localStream.getAudioTracks()[0].enabled;
      localStream.getAudioTracks()[0].enabled = !enabled;
      document.getElementById('micToggle').textContent = '–ú–∏–∫—Ä–æ—Ñ–æ–Ω: ' + (localStream.getAudioTracks()[0].enabled ? '–≤–∫–ª' : '–≤—ã–∫–ª');
    }catch(e){ alert('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É: '+e.message); }
  };

  // !!! –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤–∞—Ä–∏–∞–Ω—Ç–∞ A: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ —Å –±—É—Ñ–µ—Ä–æ–º –æ–±–º–µ–Ω–∞

  // –°–æ–∑–¥–∞—Ç—å Offer (–∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ –±—É—Ñ–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
  document.getElementById('createOffer').onclick = async ()=>{
    try{
      if(!myNick) { alert('–£—Å—Ç–∞–Ω–æ–≤–∏ –Ω–∏–∫–Ω–µ–π–º —Å–ª–µ–≤–∞ (–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º ‚Üí –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è)'); return; }
      await ensureMic(); createPeerConnection(); await addLocalTracks(pc);
      const offer = await pc.createOffer(); await pc.setLocalDescription(offer);
      await waitIceComplete(pc);
      const payload = { sdp: pc.localDescription, candidates: localCandidates, nickname: myNick };
      const txt = JSON.stringify(payload);
      document.getElementById('offerOut').value = txt;
      try{ await navigator.clipboard.writeText(txt); alert('Offer —Å–æ–∑–¥–∞–Ω –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä. –û—Ç–ø—Ä–∞–≤—å –µ–≥–æ –¥—Ä—É–≥—É.'); }
      catch(err){ alert('Offer —Å–æ–∑–¥–∞–Ω. –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø–∏—Å–∞—Ç—å –≤ –±—É—Ñ–µ—Ä (–±—Ä–∞—É–∑–µ—Ä –Ω–µ –¥–∞–ª –¥–æ—Å—Ç—É–ø) ‚Äî —Å–∫–æ–ø–∏—Ä—É–π –≤—Ä—É—á–Ω—É—é.'); }
      addOrUpdateLocal(myNick);
    }catch(e){ console.error(e); alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ Offer: '+e.message); }
  };

  // –û—Ç–≤–µ—Ç—á–∏–∫: —á–∏—Ç–∞–µ—Ç Offer –∏–∑ –±—É—Ñ–µ—Ä–∞ (–∏–ª–∏ –∏–∑ –ø–æ–ª—è), —Å–æ–∑–¥–∞–µ—Ç Answer –∏ –∫–æ–ø–∏—Ä—É–µ—Ç –µ–≥–æ –≤ –±—É—Ñ–µ—Ä
  document.getElementById('acceptOffer').onclick = async ()=>{
    try{
      // –ø—Ä–æ–±—É–µ–º –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∏–∑ –±—É—Ñ–µ—Ä–∞; –µ—Å–ª–∏ –ø—É—Å—Ç–æ ‚Äî –±–µ—Ä–µ–º –∏–∑ –ø–æ–ª—è offerIn
      let txt = '';
      try{ txt = (await navigator.clipboard.readText()).trim(); } catch(e){ txt = ''; }
      if(!txt) txt = document.getElementById('offerIn').value.trim();
      if(!txt) { alert('–í—Å—Ç–∞–≤—å Offer JSON –∏–ª–∏ —Å–∫–æ–ø–∏—Ä—É–π Offer –≤ –±—É—Ñ–µ—Ä.'); return; }

      const offerObj = JSON.parse(txt);
      remoteNick = offerObj.nickname || 'Peer';
      await ensureMic(); createPeerConnection(); await addLocalTracks(pc);

      await pc.setRemoteDescription(new RTCSessionDescription(offerObj.sdp));
      if(Array.isArray(offerObj.candidates)){
        for(const c of offerObj.candidates){ try{ await pc.addIceCandidate(new RTCIceCandidate(c)); }catch(e){ console.warn('candidate add', e); } }
      }

      const answer = await pc.createAnswer(); await pc.setLocalDescription(answer);
      await waitIceComplete(pc);
      const payload = { sdp: pc.localDescription, candidates: localCandidates, nickname: (myNick||'Guest') };
      const out = JSON.stringify(payload);
      document.getElementById('answerOut').value = out;
      try{ await navigator.clipboard.writeText(out); alert('Answer —Å–æ–∑–¥–∞–Ω –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä. –û—Ç–ø—Ä–∞–≤—å –µ–≥–æ –∑–≤–æ–Ω—è—â–µ–º—É.'); }
      catch(err){ alert('Answer —Å–æ–∑–¥–∞–Ω. –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø–∏—Å–∞—Ç—å –≤ –±—É—Ñ–µ—Ä ‚Äî —Å–∫–æ–ø–∏—Ä—É–π –≤—Ä—É—á–Ω—É—é.'); }
      addOrUpdateLocal(myNick||'Guest');
    }catch(e){ console.error(e); alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ Answer: '+e.message); }
  };

  document.getElementById('copyAnswer').onclick = ()=>{ navigator.clipboard.writeText(document.getElementById('answerOut').value); };

  // –ó–≤–æ–Ω—è—â–∏–π: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —á—Ç–µ–Ω–∏–µ Answer –∏–∑ –±—É—Ñ–µ—Ä–∞ –∏–ª–∏ –∏–∑ –ø–æ–ª—è –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
  document.getElementById('setAnswerBtn').onclick = async ()=>{
    try{
      // –ø—Ä–æ–±—É–µ–º –≤–∑—è—Ç—å –∏–∑ –±—É—Ñ–µ—Ä–∞
      let txt='';
      try{ txt = (await navigator.clipboard.readText()).trim(); }catch(e){ txt=''; }
      if(!txt) txt = document.getElementById('answerIn').value.trim();
      if(!txt){ alert('–í—Å—Ç–∞–≤—å Answer JSON –∏–ª–∏ —Å–∫–æ–ø–∏—Ä—É–π Answer –≤ –±—É—Ñ–µ—Ä.'); return; }
      const answerObj = JSON.parse(txt);
      remoteNick = answerObj.nickname || 'Peer';
      if(!pc){ alert('–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ Offer (–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∑–≤–æ–Ω—è—â–µ–≥–æ).'); return; }
      await pc.setRemoteDescription(new RTCSessionDescription(answerObj.sdp));
      if(Array.isArray(answerObj.candidates)){
        for(const c of answerObj.candidates){ try{ await pc.addIceCandidate(new RTCIceCandidate(c)); }catch(e){ console.warn('add candidate', e); } }
      }
      addOrUpdateLocal(myNick||'Guest');
      alert('Answer —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –ï—Å–ª–∏ –≤—Å—ë –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ ‚Äî –≤—ã —É–≤–∏–¥–∏—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –≤ —Å–ø–∏—Å–∫–µ –∏ —Å–º–æ–∂–µ—Ç–µ –æ–±—â–∞—Ç—å—Å—è.');
    }catch(e){ console.error(e); alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ Answer: '+e.message); }
  };

  // –î–æ–ø. –∫–Ω–æ–ø–∫–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
  document.getElementById('copyOffer')?.addEventListener('click', ()=>{ navigator.clipboard.writeText(document.getElementById('offerOut').value || ''); });
  document.getElementById('copyAnswer')?.addEventListener('click', ()=>{ navigator.clipboard.writeText(document.getElementById('answerOut').value || ''); });

})();
</script>
</body>
</html>
